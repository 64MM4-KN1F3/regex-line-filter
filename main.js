/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => RegexLineFilterPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var import_state = require("@codemirror/state");
var import_view = require("@codemirror/view");
var REGEX_HISTORY_LIMIT = 5;
var ACTIVE_FILTER_BODY_CLASS = "regex-filter-active-body";
var DEFAULT_SETTINGS = { hideEmptyLines: true, regexHistory: [] };
var setRegexEffect = import_state.StateEffect.define();
var toggleFilterEffect = import_state.StateEffect.define();
var setHideEmptyLinesEffect = import_state.StateEffect.define();
var filterViewPlugin = import_view.ViewPlugin.fromClass(
  class {
    constructor(view) {
      this.decorations = this.buildDecorations(view);
    }
    update(update) {
      if (update.docChanged || update.viewportChanged || update.state.field(filterStateField) !== update.startState.field(filterStateField)) {
        this.decorations = this.buildDecorations(update.view);
      }
    }
    buildDecorations(view) {
      const builder = new import_state.RangeSetBuilder();
      const { regex, enabled, hideEmptyLines } = view.state.field(filterStateField);
      if (!enabled || !regex) {
        return builder.finish();
      }
      const doc = view.state.doc;
      try {
        for (let i = 1; i <= doc.lines; i++) {
          const line = doc.line(i);
          const lineText = line == null ? void 0 : line.text;
          if (typeof lineText !== "string") {
            continue;
          }
          const isEmpty = lineText.trim().length === 0;
          let shouldHide = false;
          let matchesRegex = regex.test(lineText);
          if (!matchesRegex) {
            shouldHide = true;
          }
          if (hideEmptyLines && isEmpty) {
            shouldHide = true;
          }
          if (shouldHide) {
            builder.add(line.from, line.from, import_view.Decoration.line({ attributes: { class: "regex-filter-hidden-line" } }));
          }
        }
      } catch (e) {
        console.error("Regex Line Filter: Error during decoration build:", e);
      }
      return builder.finish();
    }
  },
  {
    decorations: (v) => v.decorations
  }
);
var filterStateField = import_state.StateField.define({
  create(state) {
    return {
      regex: null,
      enabled: false,
      hideEmptyLines: DEFAULT_SETTINGS.hideEmptyLines
      // Initial value from defaults
    };
  },
  update(value, tr) {
    let newValue = { ...value };
    for (let effect of tr.effects) {
      if (effect.is(setRegexEffect)) {
        newValue.regex = effect.value;
        newValue.enabled = !!effect.value;
      }
      if (effect.is(toggleFilterEffect)) {
        newValue.enabled = effect.value;
        if (effect.value && !newValue.regex) {
          newValue.enabled = false;
          console.warn("Attempted to enable filter without a regex.");
        }
        if (!effect.value) {
          newValue.enabled = false;
        }
      }
      if (effect.is(setHideEmptyLinesEffect)) {
        newValue.hideEmptyLines = effect.value;
      }
    }
    return newValue;
  }
  // Provide the state field to the view plugin if needed
  // provide: f => EditorView.decorations.from(f) // This might not be needed if using ViewPlugin explicitly
});
var RegexLineFilterPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.lastRegexStr = null;
    this.cssStyleEl = null;
  }
  async onload() {
    console.log("Loading Regex Line Filter plugin");
    await this.loadSettings();
    this.addCommand({
      id: "toggle-regex-filter",
      name: "Toggle Regex Line Filter",
      editorCallback: (editor, view) => {
        this.toggleFilter(editor, view);
      }
    });
    this.addSettingTab(new RegexLineFilterSettingTab(this.app, this));
    this.registerEditorExtension([filterStateField, filterViewPlugin]);
    this.addCss();
    this.app.workspace.onLayoutReady(() => {
      this.dispatchSettingToEditors(this.settings.hideEmptyLines);
    });
  }
  onunload() {
    console.log("Unloading Regex Line Filter plugin");
    this.removeCss();
    this.app.workspace.iterateCodeMirrors((cm) => {
      try {
        const currentFilterState = cm.state.field(filterStateField, false);
        if (currentFilterState == null ? void 0 : currentFilterState.enabled) {
          cm.dispatch({ effects: toggleFilterEffect.of(false) });
        }
      } catch (e) {
      }
    });
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
    if (!Array.isArray(this.settings.regexHistory)) {
      this.settings.regexHistory = [];
    }
    this.settings.regexHistory = this.settings.regexHistory.slice(0, REGEX_HISTORY_LIMIT);
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  updateRegexHistory(newRegexString) {
    const filteredHistory = this.settings.regexHistory.filter((r) => r !== newRegexString);
    const updatedHistory = [newRegexString, ...filteredHistory];
    this.settings.regexHistory = updatedHistory.slice(0, REGEX_HISTORY_LIMIT);
    this.saveSettings();
  }
  // Dispatch hideEmptyLines setting changes to all open editors
  dispatchSettingToEditors(newValue) {
    this.app.workspace.iterateCodeMirrors((cm) => {
      try {
        if (cm.state.field(filterStateField, false) !== void 0) {
          cm.dispatch({
            effects: setHideEmptyLinesEffect.of(newValue)
          });
        }
      } catch (e) {
        console.warn("Regex Line Filter: Error dispatching setting to an editor view", e);
      }
    });
  }
  // ----- Add CSS Modified for LEFT/RIGHT Vignette using Pseudo-elements -----
  addCss() {
    const cssId = "regex-filter-styles";
    if (document.getElementById(cssId))
      return;
    const vignetteWidth = "160px";
    const vignetteColor = "rgba(0, 0, 0, 0.4)";
    const transitionDuration = "0.3s";
    const css = `
            /* Rule to hide non-matching lines (Keep this) */
            .regex-filter-hidden-line {
                display: none !important;
            }

            /* Make view-content a positioning context for pseudo-elements */
            .workspace-leaf.mod-active .view-content {
                position: relative;
                /* Optional: May help prevent horizontal scrollbars if content is very close to edges */
                /* overflow: hidden; */
            }

            /* Define the pseudo-elements base styles */
            .workspace-leaf.mod-active .view-content::before,
            .workspace-leaf.mod-active .view-content::after {
                content: '';
                position: absolute;
                top: 0;  /* Stretch full height */
                bottom: 0; /* Stretch full height */
                width: ${vignetteWidth}; /* Define the width of the vignette */
                z-index: 5;
                pointer-events: none;
                opacity: 0;
                transition: opacity ${transitionDuration} ease-in-out;
                /* Background gradient is set below */
            }

            /* Left vignette gradient */
            .workspace-leaf.mod-active .view-content::before {
                left: 0; /* Position on the left */
                background: linear-gradient(
                    to right, /* Fade from left to right */
                    ${vignetteColor} 0%,
                    transparent 100%
                );
            }

            /* Right vignette gradient */
            .workspace-leaf.mod-active .view-content::after {
                right: 0; /* Position on the right */
                background: linear-gradient(
                    to left, /* Fade from right to left */
                    ${vignetteColor} 0%,
                    transparent 100%
                );
            }

            /* Rule to fade IN the vignettes ONLY when filter is active */
            body.${ACTIVE_FILTER_BODY_CLASS} .workspace-leaf.mod-active .view-content::before,
            body.${ACTIVE_FILTER_BODY_CLASS} .workspace-leaf.mod-active .view-content::after {
                opacity: 1; /* Fade in */
            }
        `;
    this.cssStyleEl = document.createElement("style");
    this.cssStyleEl.id = cssId;
    this.cssStyleEl.textContent = css;
    document.head.appendChild(this.cssStyleEl);
  }
  // ----- End addCss -----
  removeCss() {
    if (this.cssStyleEl) {
      this.cssStyleEl.remove();
      this.cssStyleEl = null;
    }
    const existingStyle = document.getElementById("regex-filter-styles");
    if (existingStyle) {
      existingStyle.remove();
    }
    document.body.classList.remove(ACTIVE_FILTER_BODY_CLASS);
  }
  toggleFilter(editor, view) {
    const cm = editor.cm;
    if (!cm || !(cm instanceof import_view.EditorView)) {
      new import_obsidian.Notice("Regex filter currently only works in Live Preview or Source Mode views.");
      return;
    }
    const currentFilterState = cm.state.field(filterStateField, false);
    if (currentFilterState === void 0) {
      new import_obsidian.Notice("Filter state not found for this editor. Please try toggling again, or reload the note.");
      return;
    }
    if (currentFilterState.enabled) {
      cm.dispatch({ effects: toggleFilterEffect.of(false) });
      document.body.classList.remove(ACTIVE_FILTER_BODY_CLASS);
      new import_obsidian.Notice("Regex filter disabled.");
    } else {
      this.promptForRegex(cm);
    }
  }
  promptForRegex(cm) {
    var _a, _b;
    const prefillValue = (_b = (_a = this.lastRegexStr) != null ? _a : this.settings.regexHistory[0]) != null ? _b : "";
    new RegexInputModal(
      this.app,
      prefillValue,
      this.settings.regexHistory,
      // Pass history
      (result) => {
        if (result) {
          try {
            const regex = new RegExp(result, "u");
            this.lastRegexStr = result;
            this.updateRegexHistory(result);
            cm.dispatch({
              effects: [
                setRegexEffect.of(regex)
                // This will also set enabled = true in the state field logic
              ]
            });
            document.body.classList.add(ACTIVE_FILTER_BODY_CLASS);
            new import_obsidian.Notice(`Regex filter enabled: /${result}/u`);
          } catch (e) {
            const errorMessage = e instanceof Error ? e.message : String(e);
            new import_obsidian.Notice(`Invalid Regex: ${errorMessage}`);
            console.error("Regex Compile Error:", e);
            document.body.classList.remove(ACTIVE_FILTER_BODY_CLASS);
            try {
              cm.dispatch({ effects: toggleFilterEffect.of(false) });
            } catch (e2) {
            }
          }
        } else {
          new import_obsidian.Notice("Regex filter cancelled.");
          document.body.classList.remove(ACTIVE_FILTER_BODY_CLASS);
          try {
            cm.dispatch({ effects: toggleFilterEffect.of(false) });
          } catch (e) {
          }
        }
      }
    ).open();
  }
};
var RegexLineFilterSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Regex Line Filter Settings" });
    new import_obsidian.Setting(containerEl).setName("Hide empty lines").setDesc("When the filter is active, also hide lines that contain only whitespace.").addToggle((toggle) => toggle.setValue(this.plugin.settings.hideEmptyLines).onChange(async (value) => {
      this.plugin.settings.hideEmptyLines = value;
      await this.plugin.saveSettings();
      this.plugin.dispatchSettingToEditors(value);
    }));
  }
};
var RegexInputModal = class extends import_obsidian.Modal {
  // Reference to the input element
  constructor(app, initialValue, history, onSubmit) {
    super(app);
    // To access the input element later
    this.textInputEl = null;
    this.initialValue = initialValue;
    this.history = history;
    this.onSubmit = onSubmit;
    this.result = initialValue;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "Enter Regex Filter" });
    this.inputComponent = new import_obsidian.Setting(contentEl).setName("Regular Expression (supports Unicode):").addText((text) => {
      this.textInputEl = text.inputEl;
      text.setValue(this.initialValue).setPlaceholder("e.g., ^\\s*- \\[ \\].*\u{1F4A1}").onChange((value) => {
        this.result = value;
      });
      text.inputEl.focus();
      text.inputEl.select();
      text.inputEl.addEventListener("keydown", (e) => {
        if (e.key === "Enter" && !e.shiftKey && !e.ctrlKey && !e.metaKey && !e.altKey) {
          e.preventDefault();
          this.submit();
        }
      });
    });
    this.inputComponent.controlEl.addClass("regex-filter-input-control");
    if (this.history && this.history.length > 0) {
      const historyEl = contentEl.createDiv({ cls: "regex-filter-history-container" });
      historyEl.createSpan({ text: "History:", cls: "regex-filter-history-label" });
      this.history.forEach((histEntry) => {
        const btn = historyEl.createEl("button", {
          text: `/${histEntry}/`,
          // Display regex clearly
          cls: "regex-filter-history-item",
          attr: { title: histEntry }
          // Full regex on hover
        });
        btn.addEventListener("click", () => {
          if (this.textInputEl) {
            this.textInputEl.value = histEntry;
            this.result = histEntry;
            this.textInputEl.focus();
          }
        });
      });
    }
    new import_obsidian.Setting(contentEl).addButton((btn) => btn.setButtonText("Apply Filter").setCta().onClick(() => {
      this.submit();
    })).addButton((btn) => btn.setButtonText("Cancel").onClick(() => {
      this.close();
      this.onSubmit(null);
    }));
  }
  submit() {
    if (this.result && this.result.trim().length > 0) {
      this.close();
      this.onSubmit(this.result);
    } else if (this.result === "") {
      new import_obsidian.Notice("Regex cannot be empty. Filter cancelled.");
      this.close();
      this.onSubmit(null);
    } else {
      new import_obsidian.Notice("Please enter a valid regular expression.");
      if (this.textInputEl)
        this.textInputEl.focus();
    }
  }
  onClose() {
    let { contentEl } = this;
    contentEl.empty();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldywgTW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBlZGl0b3JJbmZvRmllbGQsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRWRpdG9yU3RhdGUsIFN0YXRlRmllbGQsIFN0YXRlRWZmZWN0LCBFeHRlbnNpb24sIFJhbmdlU2V0QnVpbGRlciB9IGZyb20gJ0Bjb2RlbWlycm9yL3N0YXRlJztcbmltcG9ydCB7IERlY29yYXRpb24sIERlY29yYXRpb25TZXQsIEVkaXRvclZpZXcsIFZpZXdQbHVnaW4sIFZpZXdVcGRhdGUsIFdpZGdldFR5cGUgfSBmcm9tICdAY29kZW1pcnJvci92aWV3JztcblxuLy8gLS0tIENvbnN0YW50cyAtLS1cbmNvbnN0IFJFR0VYX0hJU1RPUllfTElNSVQgPSA1O1xuY29uc3QgQUNUSVZFX0ZJTFRFUl9CT0RZX0NMQVNTID0gJ3JlZ2V4LWZpbHRlci1hY3RpdmUtYm9keSc7XG5cbi8vIC0tLSBTZXR0aW5ncyAtLS1cbmludGVyZmFjZSBSZWdleExpbmVGaWx0ZXJTZXR0aW5ncyB7IGhpZGVFbXB0eUxpbmVzOiBib29sZWFuOyByZWdleEhpc3Rvcnk6IHN0cmluZ1tdOyB9XG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBSZWdleExpbmVGaWx0ZXJTZXR0aW5ncyA9IHsgaGlkZUVtcHR5TGluZXM6IHRydWUsIHJlZ2V4SGlzdG9yeTogW10sIH1cblxuLy8gLS0tIFN0YXRlICYgRWZmZWN0cyAtLS1cbmludGVyZmFjZSBGaWx0ZXJTdGF0ZSB7IHJlZ2V4OiBSZWdFeHAgfCBudWxsOyBlbmFibGVkOiBib29sZWFuOyBoaWRlRW1wdHlMaW5lczogYm9vbGVhbjsgfVxuY29uc3Qgc2V0UmVnZXhFZmZlY3QgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8UmVnRXhwIHwgbnVsbD4oKTtcbmNvbnN0IHRvZ2dsZUZpbHRlckVmZmVjdCA9IFN0YXRlRWZmZWN0LmRlZmluZTxib29sZWFuPigpO1xuY29uc3Qgc2V0SGlkZUVtcHR5TGluZXNFZmZlY3QgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8Ym9vbGVhbj4oKTtcblxuLy8gLS0tIFZpZXdQbHVnaW4gZGVmaW5pdGlvbiAtLS1cbmNvbnN0IGZpbHRlclZpZXdQbHVnaW4gPSBWaWV3UGx1Z2luLmZyb21DbGFzcyhcbiAgICBjbGFzcyB7XG4gICAgICAgIGRlY29yYXRpb25zOiBEZWNvcmF0aW9uU2V0O1xuICAgICAgICBjb25zdHJ1Y3Rvcih2aWV3OiBFZGl0b3JWaWV3KSB7IHRoaXMuZGVjb3JhdGlvbnMgPSB0aGlzLmJ1aWxkRGVjb3JhdGlvbnModmlldyk7IH1cbiAgICAgICAgdXBkYXRlKHVwZGF0ZTogVmlld1VwZGF0ZSkgeyBpZiAodXBkYXRlLmRvY0NoYW5nZWQgfHwgdXBkYXRlLnZpZXdwb3J0Q2hhbmdlZCB8fCB1cGRhdGUuc3RhdGUuZmllbGQoZmlsdGVyU3RhdGVGaWVsZCkgIT09IHVwZGF0ZS5zdGFydFN0YXRlLmZpZWxkKGZpbHRlclN0YXRlRmllbGQpKSB7IHRoaXMuZGVjb3JhdGlvbnMgPSB0aGlzLmJ1aWxkRGVjb3JhdGlvbnModXBkYXRlLnZpZXcpOyB9IH1cbiAgICAgICAgYnVpbGREZWNvcmF0aW9ucyh2aWV3OiBFZGl0b3JWaWV3KTogRGVjb3JhdGlvblNldCB7XG4gICAgICAgICAgICBjb25zdCBidWlsZGVyID0gbmV3IFJhbmdlU2V0QnVpbGRlcjxEZWNvcmF0aW9uPigpO1xuICAgICAgICAgICAgY29uc3QgeyByZWdleCwgZW5hYmxlZCwgaGlkZUVtcHR5TGluZXMgfSA9IHZpZXcuc3RhdGUuZmllbGQoZmlsdGVyU3RhdGVGaWVsZCk7XG4gICAgICAgICAgICBpZiAoIWVuYWJsZWQgfHwgIXJlZ2V4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJ1aWxkZXIuZmluaXNoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBkb2MgPSB2aWV3LnN0YXRlLmRvYztcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gZG9jLmxpbmVzOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZSA9IGRvYy5saW5lKGkpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lVGV4dCA9IGxpbmU/LnRleHQ7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbGluZVRleHQgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0VtcHR5ID0gbGluZVRleHQudHJpbSgpLmxlbmd0aCA9PT0gMDtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHNob3VsZEhpZGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1hdGNoZXNSZWdleCA9IHJlZ2V4LnRlc3QobGluZVRleHQpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghbWF0Y2hlc1JlZ2V4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaG91bGRIaWRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaGlkZUVtcHR5TGluZXMgJiYgaXNFbXB0eSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hvdWxkSGlkZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoc2hvdWxkSGlkZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSGlkZSB0aGUgZW50aXJlIGxpbmUgYnkgbWFya2luZyBpdHMgc3RhcnQgcG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIuYWRkKGxpbmUuZnJvbSwgbGluZS5mcm9tLCBEZWNvcmF0aW9uLmxpbmUoeyBhdHRyaWJ1dGVzOiB7IGNsYXNzOiAncmVnZXgtZmlsdGVyLWhpZGRlbi1saW5lJyB9IH0pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiUmVnZXggTGluZSBGaWx0ZXI6IEVycm9yIGR1cmluZyBkZWNvcmF0aW9uIGJ1aWxkOlwiLCBlKTtcbiAgICAgICAgICAgICAgICAvLyBQb3RlbnRpYWxseSBkaXNwYXRjaCBhbiBlZmZlY3QgdG8gZGlzYWJsZSB0aGUgZmlsdGVyIG9uIGVycm9yP1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGJ1aWxkZXIuZmluaXNoKCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgICAgZGVjb3JhdGlvbnM6ICh2KSA9PiB2LmRlY29yYXRpb25zLFxuICAgIH1cbik7XG5cbi8vIC0tLSBTdGF0ZUZpZWxkIGRlZmluaXRpb24gLS0tXG5jb25zdCBmaWx0ZXJTdGF0ZUZpZWxkID0gU3RhdGVGaWVsZC5kZWZpbmU8RmlsdGVyU3RhdGU+KHtcbiAgICBjcmVhdGUoc3RhdGUpOiBGaWx0ZXJTdGF0ZSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZWdleDogbnVsbCxcbiAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICAgICAgaGlkZUVtcHR5TGluZXM6IERFRkFVTFRfU0VUVElOR1MuaGlkZUVtcHR5TGluZXMsIC8vIEluaXRpYWwgdmFsdWUgZnJvbSBkZWZhdWx0c1xuICAgICAgICB9O1xuICAgIH0sXG4gICAgdXBkYXRlKHZhbHVlLCB0cik6IEZpbHRlclN0YXRlIHtcbiAgICAgICAgbGV0IG5ld1ZhbHVlOiBGaWx0ZXJTdGF0ZSA9IHsgLi4udmFsdWUgfTsgLy8gQ3JlYXRlIGEgbmV3IG9iamVjdCB0byBhdm9pZCBtdXRhdGlvblxuXG4gICAgICAgIGZvciAobGV0IGVmZmVjdCBvZiB0ci5lZmZlY3RzKSB7XG4gICAgICAgICAgICBpZiAoZWZmZWN0LmlzKHNldFJlZ2V4RWZmZWN0KSkge1xuICAgICAgICAgICAgICAgIG5ld1ZhbHVlLnJlZ2V4ID0gZWZmZWN0LnZhbHVlO1xuICAgICAgICAgICAgICAgIG5ld1ZhbHVlLmVuYWJsZWQgPSAhIWVmZmVjdC52YWx1ZTsgLy8gRW5hYmxlIG9ubHkgaWYgcmVnZXggaXMgdmFsaWQgYW5kIHNldFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVmZmVjdC5pcyh0b2dnbGVGaWx0ZXJFZmZlY3QpKSB7XG4gICAgICAgICAgICAgICAgIG5ld1ZhbHVlLmVuYWJsZWQgPSBlZmZlY3QudmFsdWU7XG4gICAgICAgICAgICAgICAgIC8vIElmIHRvZ2dsaW5nIG9uLCBlbnN1cmUgdGhlcmUncyBhIHJlZ2V4LiBJZiBub3QsIGZvcmNlIGRpc2FibGUuXG4gICAgICAgICAgICAgICAgIGlmIChlZmZlY3QudmFsdWUgJiYgIW5ld1ZhbHVlLnJlZ2V4KSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlLmVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiQXR0ZW1wdGVkIHRvIGVuYWJsZSBmaWx0ZXIgd2l0aG91dCBhIHJlZ2V4LlwiKTtcbiAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAvLyBJZiB0b2dnbGluZyBvZmYsIGVuc3VyZSBlbmFibGVkIGlzIGZhbHNlXG4gICAgICAgICAgICAgICAgIGlmICghZWZmZWN0LnZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlLmVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVmZmVjdC5pcyhzZXRIaWRlRW1wdHlMaW5lc0VmZmVjdCkpIHtcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZS5oaWRlRW1wdHlMaW5lcyA9IGVmZmVjdC52YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3VmFsdWU7XG4gICAgfSxcbiAgICAvLyBQcm92aWRlIHRoZSBzdGF0ZSBmaWVsZCB0byB0aGUgdmlldyBwbHVnaW4gaWYgbmVlZGVkXG4gICAgLy8gcHJvdmlkZTogZiA9PiBFZGl0b3JWaWV3LmRlY29yYXRpb25zLmZyb20oZikgLy8gVGhpcyBtaWdodCBub3QgYmUgbmVlZGVkIGlmIHVzaW5nIFZpZXdQbHVnaW4gZXhwbGljaXRseVxufSk7XG5cblxuLy8gLS0tIFBsdWdpbiBDbGFzcyBkZWZpbml0aW9uIC0tLVxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVnZXhMaW5lRmlsdGVyUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBzZXR0aW5nczogUmVnZXhMaW5lRmlsdGVyU2V0dGluZ3M7XG4gICAgbGFzdFJlZ2V4U3RyOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgICBjc3NTdHlsZUVsOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnTG9hZGluZyBSZWdleCBMaW5lIEZpbHRlciBwbHVnaW4nKTtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICd0b2dnbGUtcmVnZXgtZmlsdGVyJyxcbiAgICAgICAgICAgIG5hbWU6ICdUb2dnbGUgUmVnZXggTGluZSBGaWx0ZXInLFxuICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGVGaWx0ZXIoZWRpdG9yLCB2aWV3KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgUmVnZXhMaW5lRmlsdGVyU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG4gICAgICAgIC8vIFJlZ2lzdGVyIHRoZSBDb2RlTWlycm9yIDYgZXh0ZW5zaW9uXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFZGl0b3JFeHRlbnNpb24oW2ZpbHRlclN0YXRlRmllbGQsIGZpbHRlclZpZXdQbHVnaW5dKTtcblxuICAgICAgICAvLyBBZGQgdGhlIENTUyBydWxlc1xuICAgICAgICB0aGlzLmFkZENzcygpO1xuXG4gICAgICAgIC8vIEVuc3VyZSBzZXR0aW5ncyBhcmUgYXBwbGllZCB0byBleGlzdGluZyBlZGl0b3JzIHdoZW4gbGF5b3V0IGlzIHJlYWR5XG4gICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoU2V0dGluZ1RvRWRpdG9ycyh0aGlzLnNldHRpbmdzLmhpZGVFbXB0eUxpbmVzKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdVbmxvYWRpbmcgUmVnZXggTGluZSBGaWx0ZXIgcGx1Z2luJyk7XG4gICAgICAgIHRoaXMucmVtb3ZlQ3NzKCk7IC8vIFJlbW92ZSBDU1Mgc3R5bGVzXG4gICAgICAgIC8vIEVuc3VyZSBmaWx0ZXIgaXMgdHVybmVkIG9mZiBpbiBhbGwgZWRpdG9yc1xuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuaXRlcmF0ZUNvZGVNaXJyb3JzKGNtID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEZpbHRlclN0YXRlID0gY20uc3RhdGUuZmllbGQoZmlsdGVyU3RhdGVGaWVsZCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50RmlsdGVyU3RhdGU/LmVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY20uZGlzcGF0Y2goeyBlZmZlY3RzOiB0b2dnbGVGaWx0ZXJFZmZlY3Qub2YoZmFsc2UpIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsgLyogSWdub3JlIGVycm9ycyBpZiBmaWVsZCBkb2Vzbid0IGV4aXN0ICovIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgICAgICAgLy8gRW5zdXJlIHJlZ2V4SGlzdG9yeSBpcyBhbiBhcnJheSBhbmQgdHJpbSBpdFxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodGhpcy5zZXR0aW5ncy5yZWdleEhpc3RvcnkpKSB7XG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLnJlZ2V4SGlzdG9yeSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0dGluZ3MucmVnZXhIaXN0b3J5ID0gdGhpcy5zZXR0aW5ncy5yZWdleEhpc3Rvcnkuc2xpY2UoMCwgUkVHRVhfSElTVE9SWV9MSU1JVCk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIHVwZGF0ZVJlZ2V4SGlzdG9yeShuZXdSZWdleFN0cmluZzogc3RyaW5nKSB7XG4gICAgICAgIC8vIFJlbW92ZSBleGlzdGluZyBlbnRyeSBpZiBpdCBleGlzdHNcbiAgICAgICAgY29uc3QgZmlsdGVyZWRIaXN0b3J5ID0gdGhpcy5zZXR0aW5ncy5yZWdleEhpc3RvcnkuZmlsdGVyKHIgPT4gciAhPT0gbmV3UmVnZXhTdHJpbmcpO1xuICAgICAgICAvLyBBZGQgbmV3IGVudHJ5IHRvIHRoZSBiZWdpbm5pbmdcbiAgICAgICAgY29uc3QgdXBkYXRlZEhpc3RvcnkgPSBbbmV3UmVnZXhTdHJpbmcsIC4uLmZpbHRlcmVkSGlzdG9yeV07XG4gICAgICAgIC8vIFRyaW0gdG8gdGhlIGxpbWl0XG4gICAgICAgIHRoaXMuc2V0dGluZ3MucmVnZXhIaXN0b3J5ID0gdXBkYXRlZEhpc3Rvcnkuc2xpY2UoMCwgUkVHRVhfSElTVE9SWV9MSU1JVCk7XG4gICAgICAgIHRoaXMuc2F2ZVNldHRpbmdzKCk7XG4gICAgfVxuXG4gICAgLy8gRGlzcGF0Y2ggaGlkZUVtcHR5TGluZXMgc2V0dGluZyBjaGFuZ2VzIHRvIGFsbCBvcGVuIGVkaXRvcnNcbiAgICBkaXNwYXRjaFNldHRpbmdUb0VkaXRvcnMobmV3VmFsdWU6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLml0ZXJhdGVDb2RlTWlycm9ycyhjbSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBzdGF0ZSBmaWVsZCBleGlzdHMgYmVmb3JlIGRpc3BhdGNoaW5nXG4gICAgICAgICAgICAgICAgIGlmIChjbS5zdGF0ZS5maWVsZChmaWx0ZXJTdGF0ZUZpZWxkLCBmYWxzZSkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBjbS5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBlZmZlY3RzOiBzZXRIaWRlRW1wdHlMaW5lc0VmZmVjdC5vZihuZXdWYWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBJdCdzIHBvc3NpYmxlIGFuIGVkaXRvciBkb2Vzbid0IGhhdmUgdGhlIHN0YXRlIGZpZWxkIChlLmcuLCBjYW52YXM/KVxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIlJlZ2V4IExpbmUgRmlsdGVyOiBFcnJvciBkaXNwYXRjaGluZyBzZXR0aW5nIHRvIGFuIGVkaXRvciB2aWV3XCIsIGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyAtLS0tLSBBZGQgQ1NTIE1vZGlmaWVkIGZvciBMRUZUL1JJR0hUIFZpZ25ldHRlIHVzaW5nIFBzZXVkby1lbGVtZW50cyAtLS0tLVxuICAgIGFkZENzcygpIHtcbiAgICAgICAgY29uc3QgY3NzSWQgPSAncmVnZXgtZmlsdGVyLXN0eWxlcyc7XG4gICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjc3NJZCkpIHJldHVybjsgLy8gRG9uJ3QgYWRkIGlmIGFscmVhZHkgZXhpc3RzXG5cbiAgICAgICAgLy8gLS0tIEFkanVzdCB0aGVzZSB2YWx1ZXMgZm9yIHZpZ25ldHRlIGFwcGVhcmFuY2UgLS0tXG4gICAgICAgIGNvbnN0IHZpZ25ldHRlV2lkdGggPSAnMTYwcHgnOyAgICAgICAvLyBIb3cgV0lERSB0aGUgdmlnbmV0dGUgYXJlYSBpcyBhdCBsZWZ0L3JpZ2h0XG4gICAgICAgIGNvbnN0IHZpZ25ldHRlQ29sb3IgPSAncmdiYSgwLCAwLCAwLCAwLjQpJzsgLy8gRGFya25lc3MgYW5kIG9wYWNpdHkgb2YgdGhlIHZpZ25ldHRlXG4gICAgICAgIGNvbnN0IHRyYW5zaXRpb25EdXJhdGlvbiA9ICcwLjNzJzsgICAvLyBGYWRlLWluL291dCBzcGVlZFxuICAgICAgICAvLyAtLS0gRW5kIEFkanVzdCAtLS1cblxuICAgICAgICBjb25zdCBjc3MgPSBgXG4gICAgICAgICAgICAvKiBSdWxlIHRvIGhpZGUgbm9uLW1hdGNoaW5nIGxpbmVzIChLZWVwIHRoaXMpICovXG4gICAgICAgICAgICAucmVnZXgtZmlsdGVyLWhpZGRlbi1saW5lIHtcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qIE1ha2Ugdmlldy1jb250ZW50IGEgcG9zaXRpb25pbmcgY29udGV4dCBmb3IgcHNldWRvLWVsZW1lbnRzICovXG4gICAgICAgICAgICAud29ya3NwYWNlLWxlYWYubW9kLWFjdGl2ZSAudmlldy1jb250ZW50IHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICAgICAgICAgICAgLyogT3B0aW9uYWw6IE1heSBoZWxwIHByZXZlbnQgaG9yaXpvbnRhbCBzY3JvbGxiYXJzIGlmIGNvbnRlbnQgaXMgdmVyeSBjbG9zZSB0byBlZGdlcyAqL1xuICAgICAgICAgICAgICAgIC8qIG92ZXJmbG93OiBoaWRkZW47ICovXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qIERlZmluZSB0aGUgcHNldWRvLWVsZW1lbnRzIGJhc2Ugc3R5bGVzICovXG4gICAgICAgICAgICAud29ya3NwYWNlLWxlYWYubW9kLWFjdGl2ZSAudmlldy1jb250ZW50OjpiZWZvcmUsXG4gICAgICAgICAgICAud29ya3NwYWNlLWxlYWYubW9kLWFjdGl2ZSAudmlldy1jb250ZW50OjphZnRlciB7XG4gICAgICAgICAgICAgICAgY29udGVudDogJyc7XG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgICAgIHRvcDogMDsgIC8qIFN0cmV0Y2ggZnVsbCBoZWlnaHQgKi9cbiAgICAgICAgICAgICAgICBib3R0b206IDA7IC8qIFN0cmV0Y2ggZnVsbCBoZWlnaHQgKi9cbiAgICAgICAgICAgICAgICB3aWR0aDogJHt2aWduZXR0ZVdpZHRofTsgLyogRGVmaW5lIHRoZSB3aWR0aCBvZiB0aGUgdmlnbmV0dGUgKi9cbiAgICAgICAgICAgICAgICB6LWluZGV4OiA1O1xuICAgICAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogb3BhY2l0eSAke3RyYW5zaXRpb25EdXJhdGlvbn0gZWFzZS1pbi1vdXQ7XG4gICAgICAgICAgICAgICAgLyogQmFja2dyb3VuZCBncmFkaWVudCBpcyBzZXQgYmVsb3cgKi9cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyogTGVmdCB2aWduZXR0ZSBncmFkaWVudCAqL1xuICAgICAgICAgICAgLndvcmtzcGFjZS1sZWFmLm1vZC1hY3RpdmUgLnZpZXctY29udGVudDo6YmVmb3JlIHtcbiAgICAgICAgICAgICAgICBsZWZ0OiAwOyAvKiBQb3NpdGlvbiBvbiB0aGUgbGVmdCAqL1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudChcbiAgICAgICAgICAgICAgICAgICAgdG8gcmlnaHQsIC8qIEZhZGUgZnJvbSBsZWZ0IHRvIHJpZ2h0ICovXG4gICAgICAgICAgICAgICAgICAgICR7dmlnbmV0dGVDb2xvcn0gMCUsXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zcGFyZW50IDEwMCVcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBSaWdodCB2aWduZXR0ZSBncmFkaWVudCAqL1xuICAgICAgICAgICAgLndvcmtzcGFjZS1sZWFmLm1vZC1hY3RpdmUgLnZpZXctY29udGVudDo6YWZ0ZXIge1xuICAgICAgICAgICAgICAgIHJpZ2h0OiAwOyAvKiBQb3NpdGlvbiBvbiB0aGUgcmlnaHQgKi9cbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoXG4gICAgICAgICAgICAgICAgICAgIHRvIGxlZnQsIC8qIEZhZGUgZnJvbSByaWdodCB0byBsZWZ0ICovXG4gICAgICAgICAgICAgICAgICAgICR7dmlnbmV0dGVDb2xvcn0gMCUsXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zcGFyZW50IDEwMCVcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBSdWxlIHRvIGZhZGUgSU4gdGhlIHZpZ25ldHRlcyBPTkxZIHdoZW4gZmlsdGVyIGlzIGFjdGl2ZSAqL1xuICAgICAgICAgICAgYm9keS4ke0FDVElWRV9GSUxURVJfQk9EWV9DTEFTU30gLndvcmtzcGFjZS1sZWFmLm1vZC1hY3RpdmUgLnZpZXctY29udGVudDo6YmVmb3JlLFxuICAgICAgICAgICAgYm9keS4ke0FDVElWRV9GSUxURVJfQk9EWV9DTEFTU30gLndvcmtzcGFjZS1sZWFmLm1vZC1hY3RpdmUgLnZpZXctY29udGVudDo6YWZ0ZXIge1xuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7IC8qIEZhZGUgaW4gKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgYDtcbiAgICAgICAgdGhpcy5jc3NTdHlsZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgICAgICAgdGhpcy5jc3NTdHlsZUVsLmlkID0gY3NzSWQ7XG4gICAgICAgIHRoaXMuY3NzU3R5bGVFbC50ZXh0Q29udGVudCA9IGNzcztcbiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZCh0aGlzLmNzc1N0eWxlRWwpO1xuICAgICAgICB9XG4gICAgLy8gLS0tLS0gRW5kIGFkZENzcyAtLS0tLVxuXG5cbiAgICByZW1vdmVDc3MoKSB7XG4gICAgICAgIC8vIFJlbW92ZSBvdXIgc3BlY2lmaWMgc3R5bGUgZWxlbWVudFxuICAgICAgICBpZiAodGhpcy5jc3NTdHlsZUVsKSB7XG4gICAgICAgICAgICB0aGlzLmNzc1N0eWxlRWwucmVtb3ZlKCk7XG4gICAgICAgICAgICB0aGlzLmNzc1N0eWxlRWwgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIC8vIEFzIGEgZmFsbGJhY2ssIHRyeSByZW1vdmluZyBieSBJRCBhZ2FpbiBpbiBjYXNlIHRoZSByZWZlcmVuY2Ugd2FzIGxvc3RcbiAgICAgICAgY29uc3QgZXhpc3RpbmdTdHlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWdleC1maWx0ZXItc3R5bGVzJyk7XG4gICAgICAgIGlmIChleGlzdGluZ1N0eWxlKSB7XG4gICAgICAgICAgICBleGlzdGluZ1N0eWxlLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgICAgIC8vIENsZWFuIHVwIHRoZSBib2R5IGNsYXNzXG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZShBQ1RJVkVfRklMVEVSX0JPRFlfQ0xBU1MpO1xuICAgIH1cblxuICAgIHRvZ2dsZUZpbHRlcihlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KSB7XG4gICAgICAgIGNvbnN0IGNtID0gKGVkaXRvciBhcyBhbnkpLmNtIGFzIEVkaXRvclZpZXc7XG5cbiAgICAgICAgLy8gRW5zdXJlIHdlIGhhdmUgYSBDb2RlTWlycm9yIEVkaXRvclZpZXcgaW5zdGFuY2VcbiAgICAgICAgaWYgKCFjbSB8fCAhKGNtIGluc3RhbmNlb2YgRWRpdG9yVmlldykpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJSZWdleCBmaWx0ZXIgY3VycmVudGx5IG9ubHkgd29ya3MgaW4gTGl2ZSBQcmV2aWV3IG9yIFNvdXJjZSBNb2RlIHZpZXdzLlwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBzdGF0ZSBmaWVsZCBhY3R1YWxseSBleGlzdHMgaW4gdGhpcyBlZGl0b3IgaW5zdGFuY2VcbiAgICAgICAgY29uc3QgY3VycmVudEZpbHRlclN0YXRlID0gY20uc3RhdGUuZmllbGQoZmlsdGVyU3RhdGVGaWVsZCwgZmFsc2UpOyAvLyBVc2UgZmFsc2UgdG8gYXZvaWQgdGhyb3dpbmcgZXJyb3IgaWYgZmllbGQgbm90IHByZXNlbnRcbiAgICAgICAgaWYoY3VycmVudEZpbHRlclN0YXRlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIC8vIFRoaXMgbWlnaHQgaGFwcGVuIGlmIHRoZSBlZGl0b3Igd2FzIG9wZW5lZCBiZWZvcmUgdGhlIHBsdWdpbiBsb2FkZWQgaXRzIGV4dGVuc2lvbnMgY29tcGxldGVseVxuICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJGaWx0ZXIgc3RhdGUgbm90IGZvdW5kIGZvciB0aGlzIGVkaXRvci4gUGxlYXNlIHRyeSB0b2dnbGluZyBhZ2Fpbiwgb3IgcmVsb2FkIHRoZSBub3RlLlwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgaWYgKGN1cnJlbnRGaWx0ZXJTdGF0ZS5lbmFibGVkKSB7XG4gICAgICAgICAgICAvLyBEaXNhYmxlIGZpbHRlclxuICAgICAgICAgICAgY20uZGlzcGF0Y2goeyBlZmZlY3RzOiB0b2dnbGVGaWx0ZXJFZmZlY3Qub2YoZmFsc2UpIH0pO1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKEFDVElWRV9GSUxURVJfQk9EWV9DTEFTUyk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdSZWdleCBmaWx0ZXIgZGlzYWJsZWQuJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBFbmFibGUgZmlsdGVyIC0gUHJvbXB0IGZvciByZWdleCBmaXJzdFxuICAgICAgICAgICAgdGhpcy5wcm9tcHRGb3JSZWdleChjbSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcm9tcHRGb3JSZWdleChjbTogRWRpdG9yVmlldykge1xuICAgICAgICAvLyBQcmVmaWxsIHdpdGggdGhlIGxhc3QgdXNlZCByZWdleCwgb3IgdGhlIG1vc3QgcmVjZW50IGhpc3RvcnkgZW50cnksIG9yIGVtcHR5XG4gICAgICAgIGNvbnN0IHByZWZpbGxWYWx1ZSA9IHRoaXMubGFzdFJlZ2V4U3RyID8/IHRoaXMuc2V0dGluZ3MucmVnZXhIaXN0b3J5WzBdID8/IFwiXCI7XG4gICAgICAgIG5ldyBSZWdleElucHV0TW9kYWwoXG4gICAgICAgICAgICB0aGlzLmFwcCxcbiAgICAgICAgICAgIHByZWZpbGxWYWx1ZSxcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MucmVnZXhIaXN0b3J5LCAvLyBQYXNzIGhpc3RvcnlcbiAgICAgICAgICAgIChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgUmVnRXhwIC0gdXNlICd1JyBmbGFnIGZvciBVbmljb2RlIHN1cHBvcnRcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChyZXN1bHQsICd1Jyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdFJlZ2V4U3RyID0gcmVzdWx0OyAvLyBTdG9yZSBsYXN0IHVzZWQgcmVnZXggKHNlc3Npb24gb25seSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUmVnZXhIaXN0b3J5KHJlc3VsdCk7IC8vIFVwZGF0ZSBwZXJzaXN0ZW50IGhpc3RvcnlcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGlzcGF0Y2ggZWZmZWN0cyB0byB1cGRhdGUgcmVnZXggYW5kIGVuYWJsZSB0aGUgZmlsdGVyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbS5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBlZmZlY3RzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFJlZ2V4RWZmZWN0Lm9mKHJlZ2V4KSAvLyBUaGlzIHdpbGwgYWxzbyBzZXQgZW5hYmxlZCA9IHRydWUgaW4gdGhlIHN0YXRlIGZpZWxkIGxvZ2ljXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChBQ1RJVkVfRklMVEVSX0JPRFlfQ0xBU1MpOyAvLyBBZGQgYm9keSBjbGFzcyBmb3IgQ1NTIHN0eWxpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFJlZ2V4IGZpbHRlciBlbmFibGVkOiAvJHtyZXN1bHR9L3VgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gKGUgaW5zdGFuY2VvZiBFcnJvcikgPyBlLm1lc3NhZ2UgOiBTdHJpbmcoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBJbnZhbGlkIFJlZ2V4OiAke2Vycm9yTWVzc2FnZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJSZWdleCBDb21waWxlIEVycm9yOlwiLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVuc3VyZSBmaWx0ZXIgaXMgZGlzYWJsZWQgaWYgcmVnZXggaXMgaW52YWxpZFxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKEFDVElWRV9GSUxURVJfQk9EWV9DTEFTUyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkgeyBjbS5kaXNwYXRjaCh7IGVmZmVjdHM6IHRvZ2dsZUZpbHRlckVmZmVjdC5vZihmYWxzZSkgfSk7IH0gY2F0Y2goZSkgeyAvKiBJZ25vcmUgZXJyb3IgaWYgZmllbGQgc29tZWhvdyBub3QgYXZhaWxhYmxlICovIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZXIgY2FuY2VsbGVkXG4gICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1JlZ2V4IGZpbHRlciBjYW5jZWxsZWQuJyk7XG4gICAgICAgICAgICAgICAgICAgICAvLyBFbnN1cmUgZmlsdGVyIGlzIGRpc2FibGVkIGlmIGNhbmNlbGxlZFxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoQUNUSVZFX0ZJTFRFUl9CT0RZX0NMQVNTKTtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHsgY20uZGlzcGF0Y2goeyBlZmZlY3RzOiB0b2dnbGVGaWx0ZXJFZmZlY3Qub2YoZmFsc2UpIH0pOyB9IGNhdGNoKGUpIHsgLyogSWdub3JlIGVycm9yICovIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICkub3BlbigpO1xuICAgIH1cbn0gLy8gRW5kIG9mIFBsdWdpbiBDbGFzc1xuXG4vLyAtLS0gU2V0dGluZ3MgVGFiIENsYXNzIC0tLVxuY2xhc3MgUmVnZXhMaW5lRmlsdGVyU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwbHVnaW46IFJlZ2V4TGluZUZpbHRlclBsdWdpbjtcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBSZWdleExpbmVGaWx0ZXJQbHVnaW4pIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cblxuXHRkaXNwbGF5KCk6IHZvaWQge1xuXHRcdGNvbnN0IHtjb250YWluZXJFbH0gPSB0aGlzO1xuXG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcblxuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHt0ZXh0OiAnUmVnZXggTGluZSBGaWx0ZXIgU2V0dGluZ3MnfSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdIaWRlIGVtcHR5IGxpbmVzJylcblx0XHRcdC5zZXREZXNjKCdXaGVuIHRoZSBmaWx0ZXIgaXMgYWN0aXZlLCBhbHNvIGhpZGUgbGluZXMgdGhhdCBjb250YWluIG9ubHkgd2hpdGVzcGFjZS4nKVxuXHRcdFx0LmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5oaWRlRW1wdHlMaW5lcylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmhpZGVFbXB0eUxpbmVzID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIERpc3BhdGNoIHRoZSBjaGFuZ2UgdG8gYWxsIG9wZW4gZWRpdG9yc1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kaXNwYXRjaFNldHRpbmdUb0VkaXRvcnModmFsdWUpO1xuXHRcdFx0XHR9KSk7XG5cdH1cbn1cblxuLy8gLS0tIE1vZGFsIENsYXNzIGRlZmluaXRpb24gLS0tXG5jbGFzcyBSZWdleElucHV0TW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgcmVzdWx0OiBzdHJpbmc7XG4gICAgb25TdWJtaXQ6IChyZXN1bHQ6IHN0cmluZyB8IG51bGwpID0+IHZvaWQ7XG4gICAgaW5pdGlhbFZhbHVlOiBzdHJpbmc7XG4gICAgaGlzdG9yeTogc3RyaW5nW107IC8vIEFkZGVkIGhpc3RvcnkgcHJvcGVydHlcbiAgICBpbnB1dENvbXBvbmVudDogU2V0dGluZzsgLy8gVG8gYWNjZXNzIHRoZSBpbnB1dCBlbGVtZW50IGxhdGVyXG4gICAgdGV4dElucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQgfCBudWxsID0gbnVsbDsgLy8gUmVmZXJlbmNlIHRvIHRoZSBpbnB1dCBlbGVtZW50XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgaW5pdGlhbFZhbHVlOiBzdHJpbmcsIGhpc3Rvcnk6IHN0cmluZ1tdLCBvblN1Ym1pdDogKHJlc3VsdDogc3RyaW5nIHwgbnVsbCkgPT4gdm9pZCkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLmluaXRpYWxWYWx1ZSA9IGluaXRpYWxWYWx1ZTtcbiAgICAgICAgdGhpcy5oaXN0b3J5ID0gaGlzdG9yeTsgLy8gU3RvcmUgaGlzdG9yeVxuICAgICAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XG4gICAgICAgIHRoaXMucmVzdWx0ID0gaW5pdGlhbFZhbHVlOyAvLyBJbml0aWFsaXplIHJlc3VsdCB3aXRoIGluaXRpYWwgdmFsdWVcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTsgLy8gQ2xlYXIgcHJldmlvdXMgY29udGVudFxuXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdFbnRlciBSZWdleCBGaWx0ZXInIH0pO1xuXG4gICAgICAgIHRoaXMuaW5wdXRDb21wb25lbnQgPSBuZXcgU2V0dGluZyhjb250ZW50RWwpIC8vIFN0b3JlIHRoZSBTZXR0aW5nIG9iamVjdFxuICAgICAgICAgICAgLnNldE5hbWUoJ1JlZ3VsYXIgRXhwcmVzc2lvbiAoc3VwcG9ydHMgVW5pY29kZSk6JylcbiAgICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy50ZXh0SW5wdXRFbCA9IHRleHQuaW5wdXRFbDsgLy8gR2V0IHRoZSBpbnB1dCBlbGVtZW50XG4gICAgICAgICAgICAgICAgdGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5pbml0aWFsVmFsdWUpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignZS5nLiwgXlxcXFxzKi0gXFxcXFsgXFxcXF0uKlx1RDgzRFx1RENBMScpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIEZvY3VzIGFuZCBzZWxlY3QgdGhlIHRleHQgaW5wdXQgd2hlbiB0aGUgbW9kYWwgb3BlbnNcbiAgICAgICAgICAgICAgICB0ZXh0LmlucHV0RWwuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB0ZXh0LmlucHV0RWwuc2VsZWN0KCk7XG5cbiAgICAgICAgICAgICAgICAvLyBBZGQga2V5ZG93biBsaXN0ZW5lciBmb3IgRW50ZXIga2V5XG4gICAgICAgICAgICAgICAgdGV4dC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBTdWJtaXQgb24gRW50ZXIgdW5sZXNzIFNoaWZ0L0N0cmwvTWV0YS9BbHQgaXMgcHJlc3NlZFxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicgJiYgIWUuc2hpZnRLZXkgJiYgIWUuY3RybEtleSAmJiAhZS5tZXRhS2V5ICYmICFlLmFsdEtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsgLy8gUHJldmVudCBkZWZhdWx0IEVudGVyIGJlaGF2aW9yIChsaWtlIG5ld2xpbmUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJtaXQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQWRkIGEgc3BlY2lmaWMgY2xhc3MgdG8gdGhlIGNvbnRyb2wgZWxlbWVudCBmb3IgcG90ZW50aWFsIHN0eWxpbmdcbiAgICAgICAgIHRoaXMuaW5wdXRDb21wb25lbnQuY29udHJvbEVsLmFkZENsYXNzKCdyZWdleC1maWx0ZXItaW5wdXQtY29udHJvbCcpO1xuXG5cbiAgICAgICAgLy8gRGlzcGxheSBoaXN0b3J5IGJ1dHRvbnMgaWYgaGlzdG9yeSBpcyBub3QgZW1wdHlcbiAgICAgICAgaWYgKHRoaXMuaGlzdG9yeSAmJiB0aGlzLmhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgaGlzdG9yeUVsID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ3JlZ2V4LWZpbHRlci1oaXN0b3J5LWNvbnRhaW5lcicgfSk7XG4gICAgICAgICAgICBoaXN0b3J5RWwuY3JlYXRlU3Bhbih7IHRleHQ6ICdIaXN0b3J5OicsIGNsczogJ3JlZ2V4LWZpbHRlci1oaXN0b3J5LWxhYmVsJyB9KTtcbiAgICAgICAgICAgIHRoaXMuaGlzdG9yeS5mb3JFYWNoKGhpc3RFbnRyeSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgYnRuID0gaGlzdG9yeUVsLmNyZWF0ZUVsKCdidXR0b24nLCB7XG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IGAvJHtoaXN0RW50cnl9L2AsIC8vIERpc3BsYXkgcmVnZXggY2xlYXJseVxuICAgICAgICAgICAgICAgICAgICBjbHM6ICdyZWdleC1maWx0ZXItaGlzdG9yeS1pdGVtJyxcbiAgICAgICAgICAgICAgICAgICAgYXR0cjogeyB0aXRsZTogaGlzdEVudHJ5IH0gLy8gRnVsbCByZWdleCBvbiBob3ZlclxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudGV4dElucHV0RWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGV4dElucHV0RWwudmFsdWUgPSBoaXN0RW50cnk7IC8vIFNldCBpbnB1dCB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHQgPSBoaXN0RW50cnk7IC8vIFVwZGF0ZSBpbnRlcm5hbCByZXN1bHRcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGV4dElucHV0RWwuZm9jdXMoKTsgLy8gUmVmb2N1cyBpbnB1dFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBTdWJtaXQgYW5kIENhbmNlbCBidXR0b25zXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgICAgIC5hZGRCdXR0b24oKGJ0bikgPT4gYnRuXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0FwcGx5IEZpbHRlcicpXG4gICAgICAgICAgICAgICAgLnNldEN0YSgpIC8vIE1ha2UgaXQgdGhlIHByb21pbmVudCBidXR0b25cbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0KCk7XG4gICAgICAgICAgICAgICAgfSkpXG4gICAgICAgICAgICAuYWRkQnV0dG9uKChidG4pID0+IGJ0blxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdDYW5jZWwnKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uU3VibWl0KG51bGwpOyAvLyBJbmRpY2F0ZSBjYW5jZWxsYXRpb25cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgc3VibWl0KCkge1xuICAgICAgICAvLyBPbmx5IHN1Ym1pdCBpZiB0aGUgcmVzdWx0IGlzIG5vdCBqdXN0IHdoaXRlc3BhY2VcbiAgICAgICAgaWYgKHRoaXMucmVzdWx0ICYmIHRoaXMucmVzdWx0LnRyaW0oKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLm9uU3VibWl0KHRoaXMucmVzdWx0KTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnJlc3VsdCA9PT0gXCJcIikge1xuICAgICAgICAgICAgIC8vIEhhbmRsZSBlbXB0eSBzdHJpbmcgc3VibWlzc2lvbiBleHBsaWNpdGx5XG4gICAgICAgICAgICAgbmV3IE5vdGljZShcIlJlZ2V4IGNhbm5vdCBiZSBlbXB0eS4gRmlsdGVyIGNhbmNlbGxlZC5cIik7XG4gICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgIHRoaXMub25TdWJtaXQobnVsbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBIYW5kbGUgd2hpdGVzcGFjZS1vbmx5IGlucHV0XG4gICAgICAgICAgICBuZXcgTm90aWNlKFwiUGxlYXNlIGVudGVyIGEgdmFsaWQgcmVndWxhciBleHByZXNzaW9uLlwiKTtcbiAgICAgICAgICAgIC8vIE9wdGlvbmFsbHkgY2xlYXIgdGhlIGlucHV0IG9yIGtlZXAgaXQgYXMgaXNcbiAgICAgICAgICAgIGlmKHRoaXMudGV4dElucHV0RWwpIHRoaXMudGV4dElucHV0RWwuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uQ2xvc2UoKSB7XG4gICAgICAgIGxldCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7IC8vIENsZWFuIHVwIHRoZSBtb2RhbCBjb250ZW50XG4gICAgfVxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBb0g7QUFDcEgsbUJBQWlGO0FBQ2pGLGtCQUEwRjtBQUcxRixJQUFNLHNCQUFzQjtBQUM1QixJQUFNLDJCQUEyQjtBQUlqQyxJQUFNLG1CQUE0QyxFQUFFLGdCQUFnQixNQUFNLGNBQWMsQ0FBQyxFQUFHO0FBSTVGLElBQU0saUJBQWlCLHlCQUFZLE9BQXNCO0FBQ3pELElBQU0scUJBQXFCLHlCQUFZLE9BQWdCO0FBQ3ZELElBQU0sMEJBQTBCLHlCQUFZLE9BQWdCO0FBRzVELElBQU0sbUJBQW1CLHVCQUFXO0FBQUEsRUFDaEMsTUFBTTtBQUFBLElBRUYsWUFBWSxNQUFrQjtBQUFFLFdBQUssY0FBYyxLQUFLLGlCQUFpQixJQUFJO0FBQUEsSUFBRztBQUFBLElBQ2hGLE9BQU8sUUFBb0I7QUFBRSxVQUFJLE9BQU8sY0FBYyxPQUFPLG1CQUFtQixPQUFPLE1BQU0sTUFBTSxnQkFBZ0IsTUFBTSxPQUFPLFdBQVcsTUFBTSxnQkFBZ0IsR0FBRztBQUFFLGFBQUssY0FBYyxLQUFLLGlCQUFpQixPQUFPLElBQUk7QUFBQSxN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
